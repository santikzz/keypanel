import{K as _,r as x,j as e,S as w}from"./app-CChcUbvP.js";import{u as E,s as L,F as T,a as o,b as n,c as l,d as t,e as i,f as p,o as z,n as f,g}from"./form-BRjHhPHs.js";import{V as b}from"./index-Cf9JRL3p.js";import{B as C,d as B,a as V,t as S}from"./button-BlAtdABx.js";import{D as I,a as P,b as A,c as H,d as K,e as O}from"./dialog-CjstVSMv.js";import{I as u}from"./input-CRNYHiZ-.js";import{S as R,a as U,b as M,c as Y,d as q}from"./select-CO7wBfvd.js";import{S as G}from"./switch-D6FNVhv_.js";import{P as N}from"./plus-BglCQxxm.js";import{C as J,a as Q,S as W}from"./sticky-note-CBI77L8W.js";import{L as X}from"./layers-BBROSJXn.js";import{L as Z}from"./loader-circle-DVta5z_r.js";import"./label-Bb6zKAcF.js";import"./index-CfEDdO_o.js";import"./x-CT4G7Ssn.js";import"./createLucideIcon-Vayrc1gn.js";import"./index-CX49JTUz.js";import"./index-CEZZM7Wy.js";import"./index-CB7Kmc0d.js";import"./index-CDkRpbV9.js";import"./index-BDamJmQS.js";import"./check-BhJ5giTN.js";const $=z({duration_unit:g(),duration_value:f().min(1),note:g(),bulk_amount:f().min(1).max(256).default(1)});function Ne({application:c}){const m=_().props.auth.user,[y,F]=x.useState(!1),[j,h]=x.useState(!1),[d,k]=x.useState(!1),v=m==null?void 0:m.all_permissions.includes("KEYS_CREATE"),a=E({resolver:L($)}),D=async s=>{h(!0);const r={...s,app_id:c==null?void 0:c.id,is_bulk:d};w.post(route("licenses.store"),r,{onError:()=>{b.error("Error creating license",{style:S})},onSuccess:()=>{b.success("License created",{style:S})},onFinish:()=>h(!1)})};return e.jsx(e.Fragment,{children:e.jsxs(I,{open:y,onOpenChange:F,children:[e.jsx(P,{asChild:!0,children:e.jsxs(C,{className:"btn-primary",disabled:!v,children:[e.jsx(N,{}),"New license"]})}),e.jsxs(A,{className:"bg-zinc-950 border border-zinc-900",children:[e.jsxs(H,{children:[e.jsx(K,{children:"Create new license"}),e.jsx(O,{})]}),e.jsx(T,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(D),className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(o,{control:a.control,name:"duration_unit",render:({field:s})=>e.jsxs(n,{className:"flex flex-col flex-1 mt-2.5",children:[e.jsxs(l,{children:[e.jsx(J,{className:"inline mb-0.5 mr-1",size:14}),"Duration Unit *"]}),e.jsxs(R,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(t,{children:e.jsx(U,{children:e.jsx(M,{placeholder:"Select a time unit"})})}),e.jsx(Y,{children:B.map(r=>e.jsx(q,{value:r.value,children:r.label},r.value))})]}),e.jsx(i,{})]})}),e.jsx(o,{control:a.control,name:"duration_value",render:({field:s})=>e.jsxs(n,{className:"flex-1",children:[e.jsxs(l,{children:[e.jsx(Q,{className:"inline mb-0.5 mr-1",size:14}),"Duration Value *"]}),e.jsx(t,{children:e.jsx(u,{placeholder:"Enter a duration value",type:"number",...s,onChange:r=>s.onChange(Number(r.target.value)||0)})}),e.jsx(i,{})]})})]}),e.jsx(o,{control:a.control,name:"note",render:({field:s})=>e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(W,{className:"inline mb-0.5 mr-1",size:14}),"Note"]}),e.jsx(t,{children:e.jsx(u,{placeholder:"Frank's license",type:"text",...s})}),e.jsx(p,{children:"Add a note to better identify this license"}),e.jsx(i,{})]})}),e.jsxs(n,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{children:"Bulk create"}),e.jsx(p,{children:"Create multiple licenses at once"})]}),e.jsx(t,{children:e.jsx(G,{checked:d,onCheckedChange:k})})]}),e.jsx(o,{control:a.control,name:"bulk_amount",render:({field:s})=>e.jsxs(n,{className:V("flex-1",d?"block":"hidden"),children:[e.jsxs(l,{children:[e.jsx(X,{className:"inline mb-0.5 mr-1",size:14}),"Bulk Amount *"]}),e.jsx(t,{children:e.jsx(u,{placeholder:"How many licenses you want to create?",type:"number",...s,onChange:r=>s.onChange(Number(r.target.value)||0)})}),e.jsx(i,{})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(C,{type:"submit",className:"btn-primary",disabled:j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"animate-spin"}),"Creating license..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{})," Create license"]})})})]})})]})]})})}export{Ne as ShowCreateLicenseDialog};
