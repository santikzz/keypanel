import{K as ee,r,j as e,S as N,L as ye,A as fe,$ as P}from"./app-C38ZAMrO.js";import{V as l}from"./index-zRNEYPYS.js";import{A as ge}from"./AuthenticatedLayout-znMQlC7j.js";import{C as U,a as Ne,b as ve,c as be,d as V,e as q}from"./card-CvHYkipP.js";import{b as d,d as ke,B as i,c as Ce,t as n,f as B}from"./createLucideIcon-ADEuXVh1.js";import{B as o}from"./badge-CuoTejRf.js";import{L as p,I as se}from"./input-D_gxcHmv.js";import{T as we,a as Se,b as K,c as f,d as De,e as g}from"./table-cUjOMkDa.js";import{S as ae,a as te,b as re,c as ie,d as v}from"./select-BFSxip2d.js";import{L as _e}from"./label-fq8opIoX.js";import{D as S,a as D,b as _,c as T,d as E,e as z,f as W}from"./dialog-B58Mq984.js";import{u as Te,F as Ee,a as O,b as Y,c as G,d as Z,e as J,s as ze,o as Le,n as Ae,g as Me}from"./form-DKFavece.js";import{C as Re,a as de,S as He}from"./sticky-note-BtTTbmrF.js";import{C as oe}from"./check-CN2lLgAm.js";import{C as Q}from"./circle-check-big-DfIVvw70.js";import{C as Fe}from"./copy-CjojLFBk.js";import"./index-Cdysuist.js";import"./index-BJyibHX0.js";import"./index-D-bZHyBg.js";import"./index-CSB5jDI8.js";import"./index-BZjVY62P.js";import"./x-gOKHlL60.js";import"./package-CoIhN7DQ.js";import"./index-CqihsQTG.js";import"./index-DZUJbEff.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],$e=d("Ban",Ie);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]],Ue=d("CircleDashed",Pe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],qe=d("CircleHelp",Ve);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M16 21.16a10 10 0 1 1 5-13.516",key:"cxo92l"}],["path",{d:"M20 11.5v6",key:"2ei3xq"}],["path",{d:"M20 21.5h.01",key:"1r2dzp"}]],X=d("ClockAlert",Be);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],We=d("Clock",Ke);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],Ye=d("HardDrive",Oe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]],Ze=d("Infinity",Ge);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Qe=d("LayoutGrid",Je);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],es=d("RotateCcw",Xe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],as=d("Trash2",ss);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],rs=d("UserRound",ts),is=Le({duration_unit:Me(),duration_value:Ae().min(1)});function ds({license:s}){const a=ee().props.auth.user,b=a==null?void 0:a.all_permissions.includes("KEYS_ADD_TIME"),[k,j]=r.useState(!1),[y,h]=r.useState(!1),[x,L]=r.useState(!1),A=ke.filter(t=>t.value!=="lifetime"),u=Te({resolver:ze(is)}),C=async t=>{j(!1),h(!0),N.post(route("licenses.addtime",s==null?void 0:s.id),t,{onError:()=>{l.error("Error updating license",{style:n})},onSuccess:()=>{l.success("License time updated",{style:n})},onFinish:()=>h(!1)})};return e.jsxs(S,{open:k,onOpenChange:j,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-primary flex items-center gap-1",disabled:y||!b,children:[y?e.jsx(p,{className:"h-4 w-4"}):e.jsx(We,{className:"h-4 w-4"}),"Add Time"]})}),e.jsxs(_,{children:[e.jsxs(T,{children:[e.jsx(E,{children:"Add Time to License"}),e.jsx(z,{children:"Extend the duration of this license key."})]}),e.jsx(Ee,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(C),className:"flex flex-col gap-4",children:[e.jsx(O,{control:u.control,name:"duration_unit",render:({field:t})=>e.jsxs(Y,{className:"flex flex-col flex-1 mt-2.5",children:[e.jsxs(G,{children:[e.jsx(Re,{className:"inline mb-0.5 mr-1",size:14}),"Duration Unit *"]}),e.jsxs(ae,{onValueChange:t.onChange,defaultValue:t.value,children:[e.jsx(Z,{children:e.jsx(te,{children:e.jsx(re,{placeholder:"Select a time unit"})})}),e.jsx(ie,{children:A.map(c=>e.jsx(v,{value:c.value,children:c.label},c.value))})]}),e.jsx(J,{})]})}),e.jsx(O,{control:u.control,name:"duration_value",render:({field:t})=>e.jsxs(Y,{className:Ce("flex-1",x?"hidden":"block"),children:[e.jsxs(G,{children:[e.jsx(de,{className:"inline mb-0.5 mr-1",size:14}),"Duration Value *"]}),e.jsx(Z,{children:e.jsx(se,{placeholder:"Enter a duration value",type:"number",...t,onChange:c=>t.onChange(Number(c.target.value)||0)})}),e.jsx(J,{})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(i,{type:"submit",className:"btn-primary",children:[e.jsx(oe,{})," Add time"]})})]})})]})]})}function Ls({license:s}){const a=ee().props.auth.user,b=a==null?void 0:a.all_permissions.includes("KEYS_CREATE"),k=a==null?void 0:a.all_permissions.includes("KEYS_DELETE"),j=a==null?void 0:a.all_permissions.includes("KEYS_RESET_HWID"),[y,h]=r.useState(!1),[x,L]=r.useState("active"),[A,u]=r.useState(!1),[C,t]=r.useState(!1),[c,w]=r.useState(!1),[le,ne]=r.useState(!1),[M,R]=r.useState(!1),[H,F]=r.useState(!1),[I,$]=r.useState(!1),ce=[],me=()=>{navigator.clipboard.writeText(s==null?void 0:s.license_key),h(!0),setTimeout(()=>h(!1),2e3)},xe=()=>{R(!0),N.put(route("licenses.update",s==null?void 0:s.id),{status:x},{onError:()=>{l.error("Error updating license status",{style:n})},onSuccess:()=>{l.success("License status updated",{style:n})},onFinish:()=>R(!1)})},he=()=>{w(!1),F(!0),N.post(route("licenses.resethwid",s==null?void 0:s.id),{hwid:"RESET"},{onError:()=>{l.error("Error resetting HWID",{style:n})},onSuccess:()=>{l.success("HWID reseted",{style:n})},onFinish:()=>F(!1)})},ue=()=>{t(!1),$(!0),N.delete(route("licenses.delete",s==null?void 0:s.id),{onError:()=>{l.error("Error deleting license",{style:n})},onSuccess:()=>{l.success("License deleted",{style:n})},onFinish:()=>$(!1)})};r.useEffect(()=>{ne(x!==(s==null?void 0:s.status))},[x]);const pe=m=>{switch(m){case"unused":return e.jsxs(o,{className:"text-sm badge-primary",children:[e.jsx(Ue,{size:14,className:"mr-1"}),"Unused"]});case"active":return e.jsxs(o,{className:"text-sm badge-success",children:[e.jsx(Q,{size:14,className:"mr-1"}),"Active"]});case"expired":return e.jsxs(o,{className:"text-sm badge-danger",children:[e.jsx(X,{size:14,className:"mr-1"}),"Expired"]});case"revoked":return e.jsxs(o,{className:"text-sm badge-danger",children:[e.jsx($e,{size:14,className:"mr-1"}),"Revoked"]});default:return e.jsxs(o,{variant:"outline",children:[e.jsx(qe,{size:14,className:"mr-1"}),"Unknown"]})}},je=new Date(s==null?void 0:s.created_at).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(ge,{children:[e.jsx(ye,{title:"License Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"License Details"})}),e.jsx(U,{className:"mb-8",children:e.jsx(fe,{data:"license",fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(p,{className:"h-10 w-10 animate-spin text-indigo-700",size:32})}),children:e.jsxs(e.Fragment,{children:[e.jsx(Ne,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ve,{className:"text-xl",children:[e.jsx(Qe,{className:"inline mb-1 mr-1",size:22}),e.jsx(P,{className:"hover:underline hover:text-indigo-700",href:(s==null?void 0:s.application)&&route("applications.show",s==null?void 0:s.application.id),children:s==null?void 0:s.application.name})]}),e.jsxs(be,{children:[e.jsx(rs,{className:"inline mb-1 mr-0.5",size:14}),"Created by"," ",e.jsx(P,{className:"hover:underline hover:text-indigo-700",href:(s==null?void 0:s.issuer)&&route("applications.show",s==null?void 0:s.issuer.id),children:s==null?void 0:s.issuer.name})," on ",je]})]}),e.jsx("div",{className:"flex items-center gap-2",children:pe(s==null?void 0:s.status)})]})}),e.jsxs(V,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"License Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{value:s==null?void 0:s.license_key,readOnly:!0,className:"font-mono bg-muted"}),e.jsxs(i,{variant:"outline",size:"icon",onClick:me,className:"shrink-0",children:[y?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Copy license key"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"badge-primary aspect-square p-1.5",children:e.jsx(de,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Duration"})]}),e.jsx("p",{className:"ml-9 capitalize",children:B(s==null?void 0:s.duration,s==null?void 0:s.lifetime)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"badge-primary aspect-square p-1.5",children:e.jsx(X,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Time Left"})]}),e.jsx("p",{className:"ml-9",children:(s==null?void 0:s.status)==="unused"||(s==null?void 0:s.status)==="expired"||(s==null?void 0:s.status)==="revoked"?"N/A":s!=null&&s.lifetime?e.jsx(Ze,{}):`~ ${B(s==null?void 0:s.time_left)}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"badge-primary aspect-square p-1.5",children:e.jsx(Ye,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"HWID"})]}),e.jsx("p",{className:"ml-9",children:(s==null?void 0:s.hwid)===null?"N/A":(s==null?void 0:s.hwid)==="RESET"?e.jsx(_e,{className:"text-rose-600",children:"Pending Reset"}):s==null?void 0:s.hwid})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:"badge-primary aspect-square p-1.5",children:e.jsx(He,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Note"})]}),e.jsx("p",{className:"ml-9",children:s==null?void 0:s.note})]})]})]}),e.jsxs(q,{className:"flex flex-col sm:flex-row gap-3 border-t pt-6",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs(ae,{value:x,onValueChange:L,children:[e.jsx(te,{className:"w-full sm:w-[180px]",children:e.jsx(re,{placeholder:"Change status"})}),e.jsxs(ie,{children:[e.jsx(v,{value:"active",children:"Active"}),e.jsx(v,{value:"expired",children:"Expired"}),e.jsx(v,{value:"revoked",children:"Revoked"})]})]}),e.jsx(i,{className:"aspect-square btn-primary size-9",onClick:xe,disabled:!le||M||!b,children:M?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(oe,{})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 w-full sm:w-auto sm:ml-auto",children:[e.jsxs(S,{open:c,onOpenChange:w,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-primary flex items-center gap-1",disabled:H||(s==null?void 0:s.hwid)==="RESET"||(s==null?void 0:s.hwid)===null||!j,children:[H?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(es,{className:"h-4 w-4"}),"Reset HWID"]})}),e.jsxs(_,{children:[e.jsxs(T,{children:[e.jsx(E,{children:"Reset Hardware ID"}),e.jsx(z,{children:"Are you sure you want to reset the HWID for this license key?"})]}),e.jsxs(W,{children:[e.jsx(i,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(i,{className:"btn-primary",onClick:he,children:"Reset"})]})]})]}),e.jsx(ds,{license:s}),e.jsxs(S,{open:C,onOpenChange:t,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-danger flex items-center gap-1",disabled:I||!k,children:[I?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(as,{className:"h-4 w-4"}),"Delete"]})}),e.jsxs(_,{children:[e.jsxs(T,{children:[e.jsx(E,{children:"Delete License Key"}),e.jsx(z,{children:"This will permanently delete the license, This action cannot be undone."})]}),e.jsxs(W,{children:[e.jsx(i,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(i,{variant:"destructive",onClick:ue,children:"Delete"})]})]})]})]})]})]})})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Activity Log"}),e.jsxs(U,{children:[e.jsx(V,{className:"p-0",children:e.jsxs(we,{children:[e.jsx(Se,{children:e.jsxs(K,{children:[e.jsx(f,{children:"Date & Time"}),e.jsx(f,{children:"Action"}),e.jsx(f,{children:"User"}),e.jsx(f,{children:"IP Address"})]})}),e.jsx(De,{children:ce.map(m=>e.jsxs(K,{children:[e.jsx(g,{className:"font-mono text-sm",children:m.date}),e.jsx(g,{children:m.action}),e.jsx(g,{children:m.user}),e.jsx(g,{className:"font-mono text-sm",children:m.ip})]},m.id))})]})}),e.jsx(q,{className:"border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Showing 4 of 4 entries"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",disabled:!0,children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",disabled:!0,children:"Next"})]})]})})]})]})]})}export{Ls as default};
