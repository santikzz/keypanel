import{K as ee,r,j as e,S as N,L as fe,A as ye,$}from"./app-T4LLqA-o.js";import{V as l}from"./index-BdR1ZkQo.js";import{A as ge,H as Ne}from"./AuthenticatedLayout-W9j6D9_f.js";import{C as U,a as ve,c as be,d as ke,b as V,e as q}from"./card-y6lGfkX7.js";import{d as Ce,B as i,c as we,t as n,f as B}from"./button-4Fnn4Zm4.js";import{B as d}from"./badge-CU5SmAu2.js";import{I as se}from"./input-BMxBlm1B.js";import{T as Se,a as De,b as K,c as y,d as Te,e as g}from"./table-ABrmXgbZ.js";import{S as ae,a as te,b as re,c as ie,d as v}from"./select-D7m0JN0b.js";import{L as _e}from"./label-D3IoOerA.js";import{D as S,a as D,b as T,c as _,d as E,e as z,f as W}from"./dialog-CArG7EL7.js";import{u as Ee,F as ze,a as O,b as Y,c as G,d as Z,e as J,s as Le,o as Ae,n as Me,g as Re}from"./form-QYiQPYc4.js";import{L as p}from"./loader-circle-Dv8pZFu_.js";import{c as o}from"./createLucideIcon-Del2cXXK.js";import{C as He,a as de,S as Fe}from"./sticky-note-CYAZ9r0B.js";import{C as oe}from"./check-B8Ujda_Q.js";import{U as Ie}from"./user-round-DdSLCmZt.js";import{C as Q}from"./circle-check-big-DnaxdpDK.js";import{C as Pe}from"./copy-CWWCiqA8.js";import"./index-CXv7NyPn.js";import"./index-DZ0ENFeq.js";import"./index-C2Ig1X1a.js";import"./index-Bio6E3Lq.js";import"./index-CDe0qDmA.js";import"./index-Ch3D5kJo.js";import"./index-DFM74O4U.js";import"./x-D_uMpEYG.js";import"./package-D_1Nrbb4.js";import"./index-CKKOyhDv.js";import"./index-b-i2_jtq.js";import"./chevron-down-DcCCAuOU.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Ue=o("Ban",$e);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]],qe=o("CircleDashed",Ve);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ke=o("CircleHelp",Be);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M16 21.16a10 10 0 1 1 5-13.516",key:"cxo92l"}],["path",{d:"M20 11.5v6",key:"2ei3xq"}],["path",{d:"M20 21.5h.01",key:"1r2dzp"}]],X=o("ClockAlert",We);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Ye=o("Clock",Oe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]],Ze=o("Infinity",Ge);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Qe=o("LayoutGrid",Je);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],es=o("RotateCcw",Xe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],as=o("Trash2",ss),ts=Ae({duration_unit:Re(),duration_value:Me().min(1)});function rs({license:s}){const a=ee().props.auth.user,b=a==null?void 0:a.all_permissions.includes("KEYS_ADD_TIME"),[k,j]=r.useState(!1),[f,x]=r.useState(!1),[h,L]=r.useState(!1),A=Ce.filter(t=>t.value!=="lifetime"),u=Ee({resolver:Le(ts)}),C=async t=>{j(!1),x(!0),N.post(route("licenses.addtime",s==null?void 0:s.id),t,{onError:()=>{l.error("Error updating license",{style:n})},onSuccess:()=>{l.success("License time updated",{style:n})},onFinish:()=>x(!1)})};return e.jsxs(S,{open:k,onOpenChange:j,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-primary flex items-center gap-1",disabled:f||!b,children:[f?e.jsx(p,{className:"h-4 w-4"}):e.jsx(Ye,{className:"h-4 w-4"}),"Add Time"]})}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(E,{children:"Add Time to License"}),e.jsx(z,{children:"Extend the duration of this license key."})]}),e.jsx(ze,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(C),className:"flex flex-col gap-4",children:[e.jsx(O,{control:u.control,name:"duration_unit",render:({field:t})=>e.jsxs(Y,{className:"flex flex-col flex-1 mt-2.5",children:[e.jsxs(G,{children:[e.jsx(He,{className:"inline mb-0.5 mr-1",size:14}),"Duration Unit *"]}),e.jsxs(ae,{onValueChange:t.onChange,defaultValue:t.value,children:[e.jsx(Z,{children:e.jsx(te,{children:e.jsx(re,{placeholder:"Select a time unit"})})}),e.jsx(ie,{children:A.map(c=>e.jsx(v,{value:c.value,children:c.label},c.value))})]}),e.jsx(J,{})]})}),e.jsx(O,{control:u.control,name:"duration_value",render:({field:t})=>e.jsxs(Y,{className:we("flex-1",h?"hidden":"block"),children:[e.jsxs(G,{children:[e.jsx(de,{className:"inline mb-0.5 mr-1",size:14}),"Duration Value *"]}),e.jsx(Z,{children:e.jsx(se,{placeholder:"Enter a duration value",type:"number",...t,onChange:c=>t.onChange(Number(c.target.value)||0)})}),e.jsx(J,{})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(i,{type:"submit",className:"btn-primary",children:[e.jsx(oe,{})," Add time"]})})]})})]})]})}function Hs({license:s}){const a=ee().props.auth.user,b=a==null?void 0:a.all_permissions.includes("KEYS_CREATE"),k=a==null?void 0:a.all_permissions.includes("KEYS_DELETE"),j=a==null?void 0:a.all_permissions.includes("KEYS_RESET_HWID"),[f,x]=r.useState(!1),[h,L]=r.useState("active"),[A,u]=r.useState(!1),[C,t]=r.useState(!1),[c,w]=r.useState(!1),[le,ne]=r.useState(!1),[M,R]=r.useState(!1),[H,F]=r.useState(!1),[I,P]=r.useState(!1),ce=[],me=()=>{navigator.clipboard.writeText(s==null?void 0:s.license_key),x(!0),setTimeout(()=>x(!1),2e3)},he=()=>{R(!0),N.put(route("licenses.update",s==null?void 0:s.id),{status:h},{onError:()=>{l.error("Error updating license status",{style:n})},onSuccess:()=>{l.success("License status updated",{style:n})},onFinish:()=>R(!1)})},xe=()=>{w(!1),F(!0),N.post(route("licenses.resethwid",s==null?void 0:s.id),{hwid:"RESET"},{onError:()=>{l.error("Error resetting HWID",{style:n})},onSuccess:()=>{l.success("HWID reseted",{style:n})},onFinish:()=>F(!1)})},ue=()=>{t(!1),P(!0),N.delete(route("licenses.delete",s==null?void 0:s.id),{onError:()=>{l.error("Error deleting license",{style:n})},onSuccess:()=>{l.success("License deleted",{style:n})},onFinish:()=>P(!1)})};r.useEffect(()=>{ne(h!==(s==null?void 0:s.status))},[h]);const pe=m=>{switch(m){case"unused":return e.jsxs(d,{className:"text-sm badge-primary",children:[e.jsx(qe,{size:14,className:"mr-1"}),"Unused"]});case"active":return e.jsxs(d,{className:"text-sm badge-success",children:[e.jsx(Q,{size:14,className:"mr-1"}),"Active"]});case"expired":return e.jsxs(d,{className:"text-sm badge-danger",children:[e.jsx(X,{size:14,className:"mr-1"}),"Expired"]});case"revoked":return e.jsxs(d,{className:"text-sm badge-danger",children:[e.jsx(Ue,{size:14,className:"mr-1"}),"Revoked"]});default:return e.jsxs(d,{variant:"outline",children:[e.jsx(Ke,{size:14,className:"mr-1"}),"Unknown"]})}},je=new Date(s==null?void 0:s.created_at).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(ge,{children:[e.jsx(fe,{title:"License Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"License Details"})}),e.jsx(U,{className:"mb-8",children:e.jsx(ye,{data:"license",fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(p,{className:"h-10 w-10 animate-spin text-indigo-700",size:32})}),children:e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(be,{className:"text-xl",children:[e.jsx(Qe,{className:"inline mb-1 mr-1",size:22}),e.jsx($,{className:"hover:underline hover:text-indigo-700",href:(s==null?void 0:s.application)&&route("applications.show",s==null?void 0:s.application.id),children:s==null?void 0:s.application.name})]}),e.jsxs(ke,{children:[e.jsx(Ie,{className:"inline mb-1 mr-0.5",size:14}),"Created by"," ",e.jsx($,{className:"hover:underline hover:text-indigo-700",href:(s==null?void 0:s.issuer)&&route("applications.show",s==null?void 0:s.issuer.id),children:s==null?void 0:s.issuer.name})," on ",je]})]}),e.jsx("div",{className:"flex items-center gap-2",children:pe(s==null?void 0:s.status)})]})}),e.jsxs(V,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"License Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{value:s==null?void 0:s.license_key,readOnly:!0,className:"font-mono bg-muted"}),e.jsxs(i,{variant:"outline",size:"icon",onClick:me,className:"shrink-0",children:[f?e.jsx(Q,{className:"h-4 w-4"}):e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Copy license key"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"badge-primary aspect-square p-1.5",children:e.jsx(de,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Duration"})]}),e.jsx("p",{className:"ml-9 capitalize",children:B(s==null?void 0:s.duration,s==null?void 0:s.lifetime)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"badge-primary aspect-square p-1.5",children:e.jsx(X,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Time Left"})]}),e.jsx("p",{className:"ml-9",children:(s==null?void 0:s.status)==="unused"||(s==null?void 0:s.status)==="expired"||(s==null?void 0:s.status)==="revoked"?"N/A":s!=null&&s.lifetime?e.jsx(Ze,{}):`~ ${B(s==null?void 0:s.time_left)}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"badge-primary aspect-square p-1.5",children:e.jsx(Ne,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"HWID"})]}),e.jsx("p",{className:"ml-9",children:(s==null?void 0:s.hwid)===null?"N/A":(s==null?void 0:s.hwid)==="RESET"?e.jsx(_e,{className:"text-rose-600",children:"Pending Reset"}):s==null?void 0:s.hwid})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"badge-primary aspect-square p-1.5",children:e.jsx(Fe,{size:16})}),e.jsx("h3",{className:"text-lg font-medium",children:"Note"})]}),e.jsx("p",{className:"ml-9",children:s==null?void 0:s.note})]})]})]}),e.jsxs(q,{className:"flex flex-col sm:flex-row gap-3 border-t pt-6",children:[e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsxs(ae,{value:h,onValueChange:L,children:[e.jsx(te,{className:"w-full sm:w-[180px]",children:e.jsx(re,{placeholder:"Change status"})}),e.jsxs(ie,{children:[e.jsx(v,{value:"active",children:"Active"}),e.jsx(v,{value:"expired",children:"Expired"}),e.jsx(v,{value:"revoked",children:"Revoked"})]})]}),e.jsx(i,{className:"aspect-square btn-primary size-9",onClick:he,disabled:!le||M||!b,children:M?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(oe,{})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 w-full sm:w-auto sm:ml-auto",children:[e.jsxs(S,{open:c,onOpenChange:w,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-primary flex items-center gap-1",disabled:H||(s==null?void 0:s.hwid)==="RESET"||(s==null?void 0:s.hwid)===null||!j,children:[H?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(es,{className:"h-4 w-4"}),"Reset HWID"]})}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(E,{children:"Reset Hardware ID"}),e.jsx(z,{children:"Are you sure you want to reset the HWID for this license key?"})]}),e.jsxs(W,{children:[e.jsx(i,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(i,{className:"btn-primary",onClick:xe,children:"Reset"})]})]})]}),e.jsx(rs,{license:s}),e.jsxs(S,{open:C,onOpenChange:t,children:[e.jsx(D,{asChild:!0,children:e.jsxs(i,{size:"sm",className:"btn-danger flex items-center gap-1",disabled:I||!k,children:[I?e.jsx(p,{className:"h-4 w-4 animate-spin"}):e.jsx(as,{className:"h-4 w-4"}),"Delete"]})}),e.jsxs(T,{children:[e.jsxs(_,{children:[e.jsx(E,{children:"Delete License Key"}),e.jsx(z,{children:"This will permanently delete the license, This action cannot be undone."})]}),e.jsxs(W,{children:[e.jsx(i,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(i,{variant:"destructive",onClick:ue,children:"Delete"})]})]})]})]})]})]})})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Activity Log"}),e.jsxs(U,{children:[e.jsx(V,{className:"p-0",children:e.jsxs(Se,{children:[e.jsx(De,{children:e.jsxs(K,{children:[e.jsx(y,{children:"Date & Time"}),e.jsx(y,{children:"Action"}),e.jsx(y,{children:"User"}),e.jsx(y,{children:"IP Address"})]})}),e.jsx(Te,{children:ce.map(m=>e.jsxs(K,{children:[e.jsx(g,{className:"font-mono text-sm",children:m.date}),e.jsx(g,{children:m.action}),e.jsx(g,{children:m.user}),e.jsx(g,{className:"font-mono text-sm",children:m.ip})]},m.id))})]})}),e.jsx(q,{className:"border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Showing 4 of 4 entries"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",disabled:!0,children:"Previous"}),e.jsx(i,{variant:"outline",size:"sm",disabled:!0,children:"Next"})]})]})})]})]})]})}export{Hs as default};
