import{K as W,r as l,j as e,A as z,S as h}from"./app-T4LLqA-o.js";import{u as Y,F as Z,a as j,b as p,c as f,d as b,e as g,f as $,s as ee,o as se,g as y}from"./form-QYiQPYc4.js";import{V as i}from"./index-BdR1ZkQo.js";import{C as T,a as L,c as P,d as R,b as V}from"./card-y6lGfkX7.js";import{I as c}from"./input-BMxBlm1B.js";import{B as x,a as u,t as o}from"./button-4Fnn4Zm4.js";import{S as re,a as ae,b as te,c as le,d as v}from"./select-D7m0JN0b.js";import{L as I}from"./label-D3IoOerA.js";import{A as ne,a as ie,b as oe,c as de,d as ce,e as xe,f as ue,g as me}from"./alert-dialog-6iVyIj-j.js";import{L as m}from"./loader-circle-Dv8pZFu_.js";import{C as w}from"./check-B8Ujda_Q.js";import{C as M}from"./copy-CWWCiqA8.js";import{E as he,a as je}from"./eye-Vd38AhbY.js";import{c as pe}from"./createLucideIcon-Del2cXXK.js";import{T as O}from"./trash-DtDiSv9s.js";import{X as fe}from"./x-D_uMpEYG.js";import"./index-Bio6E3Lq.js";import"./index-CDe0qDmA.js";import"./index-CXv7NyPn.js";import"./index-Ch3D5kJo.js";import"./index-DZ0ENFeq.js";import"./index-C2Ig1X1a.js";import"./index-CKKOyhDv.js";import"./index-b-i2_jtq.js";import"./chevron-down-DcCCAuOU.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],ge=pe("RotateCw",be),ye=se({name:y(),status:y().min(0),download_url:y().optional().nullable()});function Ge({application:s}){const a=W().props.auth.user,[C,S]=l.useState(!1),[N,D]=l.useState(!1),[t,ve]=l.useState(!1),U=l.useRef(null),[d,H]=l.useState(!1),[A,E]=l.useState(!1),F=a==null?void 0:a.all_permissions.includes("APPS_UPDATE"),B=a==null?void 0:a.all_permissions.includes("APPS_DELETE"),q=(a==null?void 0:a.role)==="owner",n=Y({resolver:ee(ye)});l.useEffect(()=>{s&&n.reset({name:s==null?void 0:s.name,status:s==null?void 0:s.status,download_url:s==null?void 0:s.download_url})},[s]);const _=r=>{navigator.clipboard.writeText(r)},K=()=>H(r=>!r),X=async r=>{S(!0),h.put(route("applications.update",s.id),r,{onError:()=>{i.error("Error updating application",{style:o})},onSuccess:()=>{i.success("Application updated",{style:o})},onFinish:()=>S(!1)})},G=()=>{D(!0),h.delete(route("applications.delete",s.id),{onError:()=>{i.error("Error deleting application",{style:o})},onSuccess:()=>{i.success("Application deleted",{style:o})},onFinish:()=>D(!1)})},J=()=>{E(!0),h.post(route("applications.renewSecret",s.id),{},{preserveScroll:!0,onError:()=>{i.error("Error renewing application secret",{style:o})},onSuccess:()=>{i.success("Application secret renewed",{style:o})},onFinish:()=>E(!1)})},k=()=>e.jsx("div",{className:"flex justify-center items-center space-x-2 pb-6",children:e.jsx(m,{className:"animate-spin text-indigo-600",size:36})}),Q=()=>e.jsxs(ne,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(x,{variant:"ghost",className:"text-red-900",type:"button",disabled:N||!B,children:[N?e.jsx(m,{className:"animate-spin"}):e.jsx(O,{}),"Delete application"]})}),e.jsxs(oe,{children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Delete application?"}),e.jsx(xe,{children:"Are you sure you want to delete this application? This action will delete all asociated licenses and cannot be undone."})]}),e.jsxs(ue,{children:[e.jsxs(me,{children:[e.jsx(fe,{}),"Cancel"]}),e.jsxs(x,{variant:"destructive",onClick:G,children:[e.jsx(O,{}),"Delete"]})]})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Application details"}),e.jsx(R,{children:"Manage your application details"})]}),e.jsx(V,{children:e.jsx(z,{data:"application",fallback:e.jsx(k,{}),children:e.jsx(Z,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(X),className:"flex flex-col gap-2",children:[e.jsx(j,{control:n.control,name:"name",render:({field:r})=>e.jsxs(p,{children:[e.jsx(f,{children:"App name"}),e.jsx(b,{children:e.jsx(c,{placeholder:"Enter your application name",type:"text",...r})}),e.jsx(g,{})]})}),e.jsx(j,{control:n.control,name:"status",render:({field:r})=>e.jsxs(p,{children:[e.jsx(f,{children:"Status"}),e.jsxs(re,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(b,{children:e.jsx(ae,{children:e.jsx(te,{placeholder:"Select a status"})})}),e.jsxs(le,{children:[e.jsx(v,{value:"available",children:"Available"}),e.jsx(v,{value:"unavailable",children:"Unavailable"}),e.jsx(v,{value:"hidden",children:"Hidden"})]})]}),e.jsx(g,{})]})}),e.jsx(j,{control:n.control,name:"download_url",render:({field:r})=>e.jsxs(p,{children:[e.jsx(f,{children:"Download URL"}),e.jsx(b,{children:e.jsx(c,{placeholder:"https://example.net/downloads/release.zip",type:"text",...r})}),e.jsx($,{children:"(Optional) Download URL for launchers"}),e.jsx(g,{})]})}),e.jsxs("div",{className:"flex justify-between mt-2",children:[e.jsx(Q,{}),e.jsx(x,{type:"submit",className:"btn-primary",disabled:C||!F,children:C?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"animate-spin"}),"Saving changes..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{})," Save changes"]})})]})]})})})})]}),e.jsxs(T,{children:[e.jsxs(L,{children:[e.jsx(P,{children:"Application credentials"}),e.jsx(R,{children:"Manage your application credentials"})]}),e.jsx(V,{children:e.jsx(z,{data:"application",fallback:e.jsx(k,{}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(I,{children:"App ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{ref:U,className:"peer ps-9",readOnly:!0,value:s==null?void 0:s.app_hash_id}),e.jsxs("button",{onClick:()=>_(s==null?void 0:s.app_hash_id),className:"text-muted-foreground/80 hover:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 absolute inset-y-0 flex h-full w-9 items-center justify-center rounded-e-md transition-[color,box-shadow] outline-none focus:z-10 focus-visible:ring-[3px] disabled:pointer-events-none disabled:cursor-not-allowed","aria-label":t?"Copied":"Copy to clipboard",disabled:t,children:[e.jsx("div",{className:u("transition-all",t?"scale-100 opacity-100":"scale-0 opacity-0"),children:e.jsx(w,{className:"stroke-emerald-500",size:16,"aria-hidden":"true"})}),e.jsx("div",{className:u("absolute transition-all",t?"scale-0 opacity-0":"scale-100 opacity-100"),children:e.jsx(M,{size:16,"aria-hidden":"true"})})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(I,{children:"App Secret"}),e.jsxs("div",{className:"flex flex-row gap-3",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(c,{readOnly:!0,value:s==null?void 0:s.app_secret,className:"pe-9 peer ps-9",type:d?"text":"password"}),e.jsxs("button",{onClick:()=>_(s==null?void 0:s.app_secret),className:"text-muted-foreground/80 hover:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 absolute inset-y-0 flex h-full w-9 items-center justify-center rounded-e-md transition-[color,box-shadow] outline-none focus:z-10 focus-visible:ring-[3px] disabled:pointer-events-none disabled:cursor-not-allowed","aria-label":t?"Copied":"Copy to clipboard",disabled:t,children:[e.jsx("div",{className:u("transition-all",t?"scale-100 opacity-100":"scale-0 opacity-0"),children:e.jsx(w,{className:"stroke-emerald-500",size:16,"aria-hidden":"true"})}),e.jsx("div",{className:u("absolute transition-all",t?"scale-0 opacity-0":"scale-100 opacity-100"),children:e.jsx(M,{size:16,"aria-hidden":"true"})})]}),e.jsx("button",{className:"text-muted-foreground/80 hover:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 absolute inset-y-0 end-0 flex h-full w-9 items-center justify-center rounded-e-md transition-[color,box-shadow] outline-none focus:z-10 focus-visible:ring-[3px] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",type:"button",onClick:K,"aria-label":d?"Hide password":"Show password","aria-pressed":d,"aria-controls":"password",children:d?e.jsx(he,{size:16,"aria-hidden":"true"}):e.jsx(je,{size:16,"aria-hidden":"true"})})]}),q&&e.jsxs(x,{className:"btn-primary",disabled:!F||A,onClick:J,children:[A?e.jsx(m,{className:"animate-spin"}):e.jsx(ge,{size:16,"aria-hidden":"true"}),"Renew"]})]})]})]})})})]})]})}export{Ge as default};
