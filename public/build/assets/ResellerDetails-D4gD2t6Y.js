import{K as A,r,j as e,A as T,S as g}from"./app-C38ZAMrO.js";import{V as o}from"./index-zRNEYPYS.js";import{u as R,F as k,b as d,c,d as m,e as y,a as D,f as C,s as L,o as P,i as U,g as O,l as _}from"./form-DKFavece.js";import{B as h,h as I,t as i}from"./createLucideIcon-ADEuXVh1.js";import{I as w,L as u}from"./input-D_gxcHmv.js";import{S as V}from"./switch-Cvo3pp6M.js";import{C as z,a as B,b as H,d as W}from"./card-CvHYkipP.js";import{A as K,a as M,b as q,c as G,d as J,e as Q,f as X,g as Y}from"./alert-dialog-D2wNFZ1H.js";import{R as Z}from"./refresh-ccw-il7qzKd1.js";import{T as $}from"./trash-rksLUyQe.js";import{C as ee}from"./check-CN2lLgAm.js";import"./index-Cdysuist.js";import"./label-fq8opIoX.js";import"./index-CqihsQTG.js";import"./index-CSB5jDI8.js";const se=P({password:O().min(8).max(64).optional().or(_("")),disabled:U().optional()});function fe({reseller:s}){const t=A().props.auth.user,l=t==null?void 0:t.all_permissions.includes("RESELLER_UPDATE"),v=t==null?void 0:t.all_permissions.includes("RESELLER_DELETE"),[x,p]=r.useState(!1),[j,f]=r.useState(!1),[E,b]=r.useState(!1),n=R({resolver:L(se)}),F=a=>{console.log("test"),p(!0),g.put(route("users.updateReseller",s==null?void 0:s.id),a,{onError:()=>{o.error("Error updating reseller",{style:i})},onSuccess:()=>{o.success("Reseller updated",{style:i})},onFinish:()=>p(!1)})},S=()=>{f(!0),b(!1),g.delete(route("users.delete",s==null?void 0:s.id),{onError:()=>{o.error("Error deleting user",{style:i})},onSuccess:()=>{o.success("User deleted",{style:i})},onFinish:()=>{f(!1)}})},N=()=>{const a=I();n.setValue("password",a)};return r.useEffect(()=>{s&&n.reset({disabled:s.disabled})},[s]),e.jsxs(z,{children:[e.jsx(B,{children:e.jsx(H,{children:"Update details"})}),e.jsx(T,{data:"reseller",fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(u,{className:"h-10 w-10 animate-spin text-indigo-700",size:32})}),children:e.jsx(W,{children:e.jsx(k,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(F),className:"flex flex-col gap-4",children:[e.jsxs(d,{children:[e.jsx(c,{children:"Username"}),e.jsx(m,{children:e.jsx(w,{value:s==null?void 0:s.name,readOnly:!0,disabled:!0})}),e.jsx(y,{})]}),e.jsx(D,{control:n.control,name:"password",render:({field:a})=>e.jsxs(d,{children:[e.jsx(c,{children:"Password"}),e.jsx(m,{children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"pe-9",placeholder:"Change password",...a,disabled:!l}),e.jsx("button",{type:"button",className:"absolute inset-y-0 end-0 flex h-full w-9 items-center justify-center rounded-e-lg border border-transparent text-muted-foreground/80 outline-offset-2 transition-colors hover:text-foreground focus-visible:outline focus-visible:outline-2 focus-visible:outline-ring/70 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",onClick:N,children:e.jsx(Z,{size:16,strokeWidth:2,"aria-hidden":"true"})})]})}),e.jsx(C,{children:"Leave empty to keep the current password"}),e.jsx(y,{})]})}),e.jsx(D,{control:n.control,name:"disabled",render:({field:a})=>e.jsxs(d,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Disable account"}),e.jsx(C,{children:"When disabled, the user will not be able to log in"})]}),e.jsx(m,{children:e.jsx(V,{checked:a.value,onCheckedChange:a.onChange,disabled:!l})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(K,{open:E,onOpenChange:b,children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{type:"button",variant:"ghost",className:"text-red-500/75",disabled:j||!v,children:j?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"animate-spin"}),"Delete"]}):e.jsxs(e.Fragment,{children:[e.jsx($,{}),"Delete"]})})}),e.jsxs(q,{children:[e.jsxs(G,{children:[e.jsx(J,{children:"Are you absolutely sure?"}),e.jsx(Q,{children:"This action cannot be undone. This will permanently delete this account and cannot be undone."})]}),e.jsxs(X,{children:[e.jsx(Y,{children:"Cancel"}),e.jsx(h,{className:"btn-danger",onClick:S,children:"Delete"})]})]})]}),e.jsx(h,{type:"submit",className:"btn-primary",disabled:x||!l,children:x?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"animate-spin"})," Saving changes..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{})," Save changes"]})})]})]})})})})]})}export{fe as ResellerDetails};
