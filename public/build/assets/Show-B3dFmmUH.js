import{K as O,r as o,j as e,L as U,A as _,S as N}from"./app-Dolgd4iM.js";import{V as n}from"./index-CUV3Owv5.js";import{u as V,F as z,b as d,c as h,d as c,e as p,a as x,f as w,s as B,o as G,i as H,h as W,g as A,l as K}from"./form-CN2RbSsa.js";import{A as q}from"./AuthenticatedLayout-DO-ZyPWM.js";import{j as J,p as Q,B as u,t as m,k as X}from"./button-D0ClRWu4.js";import{I as S}from"./input-DSgG9jbb.js";import{C as Y}from"./checkbox-BaNEC8wb.js";import{L as F}from"./label-_Jex7M9b.js";import{S as Z}from"./switch-BYTeKF8L.js";import{C as $,a as ee,c as se,b as re}from"./card-DfWChW0z.js";import{A as te,a as ae,b as le,c as ie,d as oe,e as ne,f as de,g as ce}from"./alert-dialog-C4yHBdv3.js";import{R as me}from"./refresh-ccw-DkClB5_C.js";import{L as j}from"./loader-circle-C8BvkExV.js";import{T as he}from"./trash-CsxxVzs-.js";import{C as pe}from"./check-Cur-CPmi.js";import"./index-BT6SQ-2-.js";import"./index-Bss0tgsO.js";import"./index-Dit_NJU4.js";import"./index-C_F-sgyr.js";import"./index-BeD3hcVn.js";import"./index-C9uZe4dc.js";import"./index-BHIaToBe.js";import"./createLucideIcon-BnrLvxL-.js";import"./x-B5M3iq-V.js";import"./package-C8J_lC1A.js";import"./index-C13PvmDz.js";const xe=G({password:A().min(8).max(64).optional().or(K("")),permissions:W(A()).optional(),disabled:H().optional()});function ze({manager:s}){const a=O().props.auth.user,l=a==null?void 0:a.all_permissions.includes("MANAGER_UPDATE"),k=a==null?void 0:a.all_permissions.includes("MANAGER_DELETE"),[f,b]=o.useState(!1),[g,y]=o.useState(!1),[E,C]=o.useState(!1),t=V({resolver:B(xe)}),T=r=>{console.log("test"),b(!0),N.put(route("users.updateManager",s==null?void 0:s.id),r,{onError:()=>{n.error("Error updating manager",{style:m})},onSuccess:()=>{n.success("Manager updated",{style:m})},onFinish:()=>b(!1)})},P=()=>{y(!0),C(!1),N.delete(route("users.delete",s==null?void 0:s.id),{onError:()=>{n.error("Error deleting user",{style:m})},onSuccess:()=>{n.success("User deleted",{style:m})},onFinish:()=>{y(!1)}})},L=()=>{const r=X();t.setValue("password",r)};return o.useEffect(()=>{s&&t.reset({permissions:s.all_permissions,disabled:s.disabled})},[s]),e.jsxs(q,{children:[e.jsx(U,{title:"Manager Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Manager Details"})}),e.jsxs($,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Update details"})}),e.jsx(_,{data:"manager",fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"h-10 w-10 animate-spin text-indigo-700",size:32})}),children:e.jsx(re,{children:e.jsx(z,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(T),className:"flex flex-col gap-4",children:[e.jsxs(d,{children:[e.jsx(h,{children:"Username"}),e.jsx(c,{children:e.jsx(S,{value:s==null?void 0:s.name,readOnly:!0,disabled:!0})}),e.jsx(p,{})]}),e.jsx(x,{control:t.control,name:"password",render:({field:r})=>e.jsxs(d,{children:[e.jsx(h,{children:"Password"}),e.jsx(c,{children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"pe-9",placeholder:"Change password",...r,disabled:!l}),e.jsx("button",{type:"button",className:"absolute inset-y-0 end-0 flex h-full w-9 items-center justify-center rounded-e-lg border border-transparent text-muted-foreground/80 outline-offset-2 transition-colors hover:text-foreground focus-visible:outline focus-visible:outline-2 focus-visible:outline-ring/70 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",onClick:L,children:e.jsx(me,{size:16,strokeWidth:2,"aria-hidden":"true"})})]})}),e.jsx(w,{children:"Leave empty to keep the current password"}),e.jsx(p,{})]})}),e.jsx(x,{control:t.control,name:"permissions",render:({field:r})=>e.jsxs(e.Fragment,{children:[e.jsx(F,{children:"Permissions"}),e.jsxs(d,{className:"flex flex-col space-y-2 rounded-md border p-4",children:[e.jsx(c,{children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:J.map((i,v)=>{var D;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{checked:((D=r.value)==null?void 0:D.includes(i))||!1,onCheckedChange:M=>{const R=M?[...r.value||[],i]:(r.value||[]).filter(I=>I!==i);r.onChange(R)},disabled:!l},v),e.jsx(F,{className:"uppercase text-xs",children:Q(i)})]},v)})})}),e.jsx(p,{})]})]})}),e.jsx(x,{control:t.control,name:"disabled",render:({field:r})=>e.jsxs(d,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(h,{children:"Disable account"}),e.jsx(w,{children:"When disabled, the user will not be able to log in"})]}),e.jsx(c,{children:e.jsx(Z,{checked:r.value,onCheckedChange:r.onChange,disabled:!l})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(te,{open:E,onOpenChange:C,children:[e.jsx(ae,{asChild:!0,children:e.jsx(u,{type:"button",variant:"ghost",className:"text-red-500/75",disabled:g||!k,children:g?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"animate-spin"}),"Delete"]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{}),"Delete"]})})}),e.jsxs(le,{children:[e.jsxs(ie,{children:[e.jsx(oe,{children:"Are you absolutely sure?"}),e.jsx(ne,{children:"This action cannot be undone. This will permanently delete this account and cannot be undone."})]}),e.jsxs(de,{children:[e.jsx(ce,{children:"Cancel"}),e.jsx(u,{className:"btn-danger",onClick:P,children:"Delete"})]})]})]}),e.jsx(u,{type:"submit",className:"btn-primary",disabled:f||!l,children:f?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"animate-spin"})," Saving changes..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{})," Save changes"]})})]})]})})})})]})]})]})}export{ze as default};
