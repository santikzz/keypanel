import{K as O,r as i,j as e,L as U,A as _,S as N}from"./app-BTBLTgKa.js";import{V as o}from"./index-C0Aybrov.js";import{u as V,F as z,b as d,c as m,d as c,e as x,a as p,f as w,s as B,o as G,i as H,h as W,g as A,l as K}from"./form-Ewck4cr5.js";import{A as q}from"./AuthenticatedLayout-ChSu_qVk.js";import{g as J,p as Q,B as u,t as h,h as X}from"./createLucideIcon-Dk4g4Rfc.js";import{I as S,L as j}from"./input-DPBk8N_M.js";import{C as Y}from"./checkbox-Dw-5dZAd.js";import{L as F}from"./label-8Biq_GbJ.js";import{S as Z}from"./switch-BIbmNQHN.js";import{C as $,a as ee,b as se,d as re}from"./card-CUhwYfK6.js";import{A as te,a as ae,b as le,c as ne,d as ie,e as oe,f as de,g as ce}from"./alert-dialog-gwaJx6Ol.js";import{R as he}from"./refresh-ccw-CRG4HO2M.js";import{T as me}from"./trash-CPK-TJTn.js";import{C as xe}from"./check-DyFLvgFN.js";import"./index-Uk3LIZDJ.js";import"./index-9Zp9f-9W.js";import"./index-DuTKQBgG.js";import"./index-cyAClCp9.js";import"./index-BPDlF92w.js";import"./x-Dpj60ZH6.js";import"./package-Bg3_ZOXw.js";import"./index-DqEWQkQn.js";const pe=G({password:A().min(8).max(64).optional().or(K("")),permissions:W(A()).optional(),disabled:H().optional()});function Oe({manager:s}){const a=O().props.auth.user,l=a==null?void 0:a.all_permissions.includes("MANAGER_UPDATE"),E=a==null?void 0:a.all_permissions.includes("MANAGER_DELETE"),[f,b]=i.useState(!1),[g,y]=i.useState(!1),[T,C]=i.useState(!1),t=V({resolver:B(pe)}),k=r=>{console.log("test"),b(!0),N.put(route("users.updateManager",s==null?void 0:s.id),r,{onError:()=>{o.error("Error updating manager",{style:h})},onSuccess:()=>{o.success("Manager updated",{style:h})},onFinish:()=>b(!1)})},P=()=>{y(!0),C(!1),N.delete(route("users.delete",s==null?void 0:s.id),{onError:()=>{o.error("Error deleting user",{style:h})},onSuccess:()=>{o.success("User deleted",{style:h})},onFinish:()=>{y(!1)}})},L=()=>{const r=X();t.setValue("password",r)};return i.useEffect(()=>{s&&t.reset({permissions:s.all_permissions,disabled:s.disabled})},[s]),e.jsxs(q,{children:[e.jsx(U,{title:"Manager Details"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Manager Details"})}),e.jsxs($,{children:[e.jsx(ee,{children:e.jsx(se,{children:"Update details"})}),e.jsx(_,{data:"manager",fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(j,{className:"h-10 w-10 animate-spin text-indigo-700",size:32})}),children:e.jsx(re,{children:e.jsx(z,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(k),className:"flex flex-col gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:"Username"}),e.jsx(c,{children:e.jsx(S,{value:s==null?void 0:s.name,readOnly:!0,disabled:!0})}),e.jsx(x,{})]}),e.jsx(p,{control:t.control,name:"password",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Password"}),e.jsx(c,{children:e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"pe-9",placeholder:"Change password",...r,disabled:!l}),e.jsx("button",{type:"button",className:"absolute inset-y-0 end-0 flex h-full w-9 items-center justify-center rounded-e-lg border border-transparent text-muted-foreground/80 outline-offset-2 transition-colors hover:text-foreground focus-visible:outline focus-visible:outline-2 focus-visible:outline-ring/70 disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",onClick:L,children:e.jsx(he,{size:16,strokeWidth:2,"aria-hidden":"true"})})]})}),e.jsx(w,{children:"Leave empty to keep the current password"}),e.jsx(x,{})]})}),e.jsx(p,{control:t.control,name:"permissions",render:({field:r})=>e.jsxs(e.Fragment,{children:[e.jsx(F,{children:"Permissions"}),e.jsxs(d,{className:"flex flex-col space-y-2 rounded-md border p-4",children:[e.jsx(c,{children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:J.map((n,v)=>{var D;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{checked:((D=r.value)==null?void 0:D.includes(n))||!1,onCheckedChange:M=>{const R=M?[...r.value||[],n]:(r.value||[]).filter(I=>I!==n);r.onChange(R)},disabled:!l},v),e.jsx(F,{className:"uppercase text-xs",children:Q(n)})]},v)})})}),e.jsx(x,{})]})]})}),e.jsx(p,{control:t.control,name:"disabled",render:({field:r})=>e.jsxs(d,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{children:"Disable account"}),e.jsx(w,{children:"When disabled, the user will not be able to log in"})]}),e.jsx(c,{children:e.jsx(Z,{checked:r.value,onCheckedChange:r.onChange,disabled:!l})})]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(te,{open:T,onOpenChange:C,children:[e.jsx(ae,{asChild:!0,children:e.jsx(u,{type:"button",variant:"ghost",className:"text-red-500/75",disabled:g||!E,children:g?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"animate-spin"}),"Delete"]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{}),"Delete"]})})}),e.jsxs(le,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Are you absolutely sure?"}),e.jsx(oe,{children:"This action cannot be undone. This will permanently delete this account and cannot be undone."})]}),e.jsxs(de,{children:[e.jsx(ce,{children:"Cancel"}),e.jsx(u,{className:"btn-danger",onClick:P,children:"Delete"})]})]})]}),e.jsx(u,{type:"submit",className:"btn-primary",disabled:f||!l,children:f?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"animate-spin"})," Saving changes..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{})," Save changes"]})})]})]})})})})]})]})]})}export{Oe as default};
