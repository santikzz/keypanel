import{K as L,r as d,j as e,A as V,S as A}from"./app-C38ZAMrO.js";import{u as B,s as I,F as P,a as t,b as a,c as l,d as i,e as o,f as b,o as H,n as f,g as x}from"./form-DKFavece.js";import{V as C}from"./index-zRNEYPYS.js";import{b as K,B as j,d as M,a as O,t as N}from"./createLucideIcon-ADEuXVh1.js";import{D as R,a as U,b as q,c as Y,d as G,e as J}from"./dialog-B58Mq984.js";import{I as u,L as Q}from"./input-D_gxcHmv.js";import{S as y,a as S,b as k,c as v,d as F}from"./select-BFSxip2d.js";import{S as W}from"./switch-Cvo3pp6M.js";import{P as h}from"./plus-C_OsLn3X.js";import{C as X,a as Z,S as $}from"./sticky-note-BtTTbmrF.js";import{L as ee}from"./layers-zLnmmou_.js";import"./label-fq8opIoX.js";import"./index-Cdysuist.js";import"./x-gOKHlL60.js";import"./index-D-bZHyBg.js";import"./index-CSB5jDI8.js";import"./index-BJyibHX0.js";import"./index-CqihsQTG.js";import"./index-DZUJbEff.js";import"./check-CN2lLgAm.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],re=K("Tag",se),ne=H({app_id:x(),duration_unit:x(),duration_value:f().min(1),note:x(),bulk_amount:f().min(1).max(256).default(1)});function ke({applications:_}){const c=L().props.auth.user,D=c==null?void 0:c.all_permissions.includes("KEYS_CREATE"),[w,T]=d.useState(!1),[g,p]=d.useState(!1),[m,z]=d.useState(!1),n=B({resolver:I(ne)}),E=async r=>{p(!0);const s={...r,is_bulk:m};A.post(route("licenses.store"),s,{onError:()=>{C.error("Error creating license",{style:N})},onSuccess:()=>{C.success("License created",{style:N})},onFinish:()=>p(!1)})};return e.jsx(e.Fragment,{children:e.jsx(V,{data:"applications",fallback:e.jsxs(j,{className:"btn-primary",disabled:!0,children:[" ",e.jsx(h,{}),"New license"]}),children:e.jsxs(R,{open:w,onOpenChange:T,children:[e.jsx(U,{asChild:!0,children:e.jsxs(j,{className:"btn-primary",disabled:!D,children:[e.jsx(h,{}),"New license"]})}),e.jsxs(q,{className:"bg-zinc-950 border border-zinc-900",children:[e.jsxs(Y,{children:[e.jsx(G,{children:"Create new license"}),e.jsx(J,{})]}),e.jsx(P,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(E),className:"flex flex-col gap-4",children:[e.jsx(t,{control:n.control,name:"app_id",render:({field:r})=>e.jsxs(a,{children:[e.jsxs(l,{children:[e.jsx(re,{className:"inline mr-0.5",size:14}),"Application *"]}),e.jsxs(y,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(i,{children:e.jsx(S,{children:e.jsx(k,{placeholder:"Select an application"})})}),e.jsx(v,{children:_.map(s=>e.jsx(F,{value:s==null?void 0:s.id,children:s==null?void 0:s.name},s==null?void 0:s.id))})]}),e.jsx(o,{})]})}),e.jsxs("div",{className:"flex flex-row gap-4",children:[e.jsx(t,{control:n.control,name:"duration_unit",render:({field:r})=>e.jsxs(a,{className:"flex flex-col flex-1 mt-2.5",children:[e.jsxs(l,{children:[e.jsx(X,{className:"inline mb-0.5 mr-1",size:14}),"Duration Unit *"]}),e.jsxs(y,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(i,{children:e.jsx(S,{children:e.jsx(k,{placeholder:"Select a time unit"})})}),e.jsx(v,{children:M.map(s=>e.jsx(F,{value:s.value,children:s.label},s.value))})]}),e.jsx(o,{})]})}),e.jsx(t,{control:n.control,name:"duration_value",render:({field:r})=>e.jsxs(a,{className:"flex-1",children:[e.jsxs(l,{children:[e.jsx(Z,{className:"inline mb-0.5 mr-1",size:14}),"Duration Value *"]}),e.jsx(i,{children:e.jsx(u,{placeholder:"Enter a duration value",type:"number",...r,onChange:s=>r.onChange(Number(s.target.value)||0)})}),e.jsx(o,{})]})})]}),e.jsx(t,{control:n.control,name:"note",render:({field:r})=>e.jsxs(a,{children:[e.jsxs(l,{children:[e.jsx($,{className:"inline mb-0.5 mr-1",size:14}),"Note"]}),e.jsx(i,{children:e.jsx(u,{placeholder:"Frank's license",type:"text",...r})}),e.jsx(b,{children:"Add a note to better identify this license"}),e.jsx(o,{})]})}),e.jsxs(a,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{children:"Bulk create"}),e.jsx(b,{children:"Create multiple licenses at once"})]}),e.jsx(i,{children:e.jsx(W,{checked:m,onCheckedChange:z})})]}),e.jsx(t,{control:n.control,name:"bulk_amount",render:({field:r})=>e.jsxs(a,{className:O("flex-1",m?"block":"hidden"),children:[e.jsxs(l,{children:[e.jsx(ee,{className:"inline mb-0.5 mr-1",size:14}),"Bulk Amount *"]}),e.jsx(i,{children:e.jsx(u,{placeholder:"How many licenses you want to create?",type:"number",...r,onChange:s=>r.onChange(Number(s.target.value)||0)})}),e.jsx(o,{})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(j,{type:"submit",className:"btn-primary",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"animate-spin"}),"Creating license..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{})," Create license"]})})})]})})]})]})})})}export{ke as IndexCreateLicenseDialog};
